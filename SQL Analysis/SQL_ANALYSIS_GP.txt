------------------------------------------------------------1.Find Distinct Category----------------------------------------------------

SELECT DISTINCT CATEGORY FROM "DEMO_DATABASE"."PUBLIC"."VP_PLAYSTOREDATA"

SELECT COUNT(DISTINCT CATEGORY) FROM "DEMO_DATABASE"."PUBLIC"."VP_PLAYSTOREDATA"

------------------------------------------------------------20.Count of Apps Category wise--------------------------------------------------

SELECT CATEGORY, COUNT(APP) as total_apps_categorywise 
FROM "DEMO_DATABASE"."PUBLIC"."VP_PLAYSTOREDATA"
GROUP BY 1

---------------------------------------------------------------2.Top 10 Installed Apps------------------------------------------------------

SELECT APP,CATEGORY,INSTALLS
FROM "DEMO_DATABASE"."PUBLIC"."VP_PLAYSTOREDATA"
ORDER BY 3 DESC 
LIMIT 10

-----------------------------------------------------------3.Top 3 most popular Categories------------------------------------------------------
SELECT CATEGORY,SUM(INSTALLS)
FROM "DEMO_DATABASE"."PUBLIC"."VP_PLAYSTOREDATA"
GROUP BY 1
ORDER BY 2 DESC
LIMIT 3

----------------------------------------------------------------4.Top 1/2 Apps per Category based on installation-------------------------------------------------------

SELECT * FROM
(SELECT APP ,CATEGORY AS CT,installs AS MR,DENSE_RANK() OVER(PARTITION BY CATEGORY ORDER BY installs DESC ) AS RR
FROM "DEMO_DATABASE"."PUBLIC"."VP_PLAYSTOREDATA")
WHERE RR in (1,2)
----------------------------------------------------------------5.Free vs Paid App(%)---------------------------------------------------------------
with ctw as
(select count(*) as ct from "DEMO_DATABASE"."PUBLIC"."VP_PLAYSTOREDATA")
SELECT TYPE,(COUNT(*)/(select ct from ctw))*100 FROM "DEMO_DATABASE"."PUBLIC"."VP_PLAYSTOREDATA"
GROUP BY 1

--------------------------------------------------------------6.No. of apps supported by latest android version-------------------------------------
--select max(android_ver) from "DEMO_DATABASE"."PUBLIC"."VP_PLAYSTOREDATA"

---------------------------------------------------------------7.Revenue generated by paid apps based on installation.(no. of installation * Charges)----------
select app, installs*price as pricee
FROM "DEMO_DATABASE"."PUBLIC"."VP_PLAYSTOREDATA"
where type='Paid'
order by 2 desc

--------------------------------------------------------------8.Lowest Rated Apps(installation wise)------------------------------------------------------------
---------------------------------------------------------------lowest rated apps-----------------------------------------
select app 
FROM "DEMO_DATABASE"."PUBLIC"."VP_PLAYSTOREDATA"
where rating=(select min(rating) from "DEMO_DATABASE"."PUBLIC"."VP_PLAYSTOREDATA")

-----------------------------------------------------------------lowest installed apps------------------------------------
select app ,installs
FROM "DEMO_DATABASE"."PUBLIC"."VP_PLAYSTOREDATA"
where installs=(select min(installs) from "DEMO_DATABASE"."PUBLIC"."VP_PLAYSTOREDATA")

----------------------------------------------------------------9. Largest and smallest apps by size(based on installation)-------------------------


-----------------------------------------------------------------10.Content rating -----------------------------------------
select content_rating,count(*) from "DEMO_DATABASE"."PUBLIC"."VP_PLAYSTOREDATA"
group by 1
-------------------------------------------------------------content wise no of ratings-----------------------------------
select content_rating,count(distinct(category)) from "DEMO_DATABASE"."PUBLIC"."VP_PLAYSTOREDATA"
group by 1
-------------------------------------------------------------content wise top installed apps--------------------------------
select * from
(select app,installs as mm,content_rating,dense_rank()over(partition by content_rating order by installs desc )as dr
from "DEMO_DATABASE"."PUBLIC"."VP_PLAYSTOREDATA")
where dr in(1,2,3)
-------------------------------------------------------------11.Overall avg Rating-------------------------------------------------------

select round(avg(rating),2)
from "DEMO_DATABASE"."PUBLIC"."VP_PLAYSTOREDATA"

-----------------------------------------------------------------category wise avg rating-------------------------------
select category,round(avg(rating),2) as avg_rating
from "DEMO_DATABASE"."PUBLIC"."VP_PLAYSTOREDATA"
group by 1
order by 2 desc

------------------------------------------------------------------12.Avg app rating based on types(Free/Paid)----------------------------------------
select type,round(avg(rating),2) as avg_rating
from "DEMO_DATABASE"."PUBLIC"."VP_PLAYSTOREDATA"
group by 1
-------------------------------------------------------------------13.Revenue generated acc to Content rating.--------------------------------------

select Content_rating,sum(installs*price) as revenue_per_group
from "DEMO_DATABASE"."PUBLIC"."VP_PLAYSTOREDATA"
group by 1
----------------------------------------------------------------------14.Total Downloads Per Category (Top 10)----------------------------------
select Category,sum(installs) as total_installation
from "DEMO_DATABASE"."PUBLIC"."VP_PLAYSTOREDATA"
group by 1
------------------------------------------------------------------------15.Top Expensive apps /(Category wise)------------------------------------
---------------------------------------------------------------Category wise----------------------------------------------------------------------
select * from(
select category,app,installs*price as revenue, dense_rank()over(partition by category order by revenue desc) as rnk
from "DEMO_DATABASE"."PUBLIC"."VP_PLAYSTOREDATA")
where rnk in (1,2)
---------------------------------------------------------------content_rating wise-------------------------------------------------------------------
select * from(
select content_rating,app,installs*price as revenue, dense_rank()over(partition by content_rating order by revenue desc) as rnk
from "DEMO_DATABASE"."PUBLIC"."VP_PLAYSTOREDATA")
where rnk in (1,2)
-------------------------------------------------------------------------------16.Top 10 Rated apps-----------------------------------
select app,round(rating,2) 
from "DEMO_DATABASE"."PUBLIC"."VP_PLAYSTOREDATA"
order by 2 desc
limit 20
-------------------------------------------------------------------------------17.Type vs Rating category wise------------------------------------
----------------------------------------------------------------------------------------------
select * from
(select type,rating,installs, dense_rank()over(partition by type order by rating desc)as rnk
from "DEMO_DATABASE"."PUBLIC"."VP_PLAYSTOREDATA")
where rnk=1
----------------------------------------------------------------------------------------------
select * from
(select type,rating,installs, dense_rank()over(partition by type order by installs desc)as rnk
from "DEMO_DATABASE"."PUBLIC"."VP_PLAYSTOREDATA")
where rnk=1
---------------------------------------------------------------------------------18.Total revenue of paid apps---------------------------------
select type, sum(installs*price)as pricee
FROM "DEMO_DATABASE"."PUBLIC"."VP_PLAYSTOREDATA"
group by 1
having type='Paid'

